<!DOCTYPE html>
<html>
<head>
    <title>TestAufgabe</title>
    <link rel="stylesheet" href="src/leaflet.css" />
    <link rel="stylesheet" href="src/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="map.css"/>


    <script src="src/leaflet-src.js"></script>
    <script src="src/jquery-3.3.1.min.js"></script>
    <script src="src/plugins/sweetalert-master/docs/assets/sweetalert/sweetalert.min.js"></script>
</head>
<body>
<div id="mapdiv"></div>
<script type="text/javascript">
    var marker=[];
    var poly=[];
    var map;
    var op1,op2;
    var mapzoom;
    var length;
    var mark;

    var answer;
    var latlng;


    $(document).ready(function(){
        function test() {
            if (window.XMLHttpRequest)
            {// code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp=new XMLHttpRequest();
            }
            else
            {// code for IE6, IE5
                xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.open("GET","Aufgabe1.xml",false);//Read Example.xml
            xmlhttp.send();
            //var text=xmlhttp.responseText;
            var xmlDoc=xmlhttp.responseXML;//XML Object

            //alert(text);
            //var parser=new DOMParser();
            //var xmlDoc1=parser.parseFromString(text,"text/xml");//String to XML Object
            //alert(xmlDoc1+" answer");
            var aufgabe=xmlDoc.getElementsByTagName("Aufgabe");
            //alert(aufgabe.length);

            alert(aufgabe[0].getElementsByTagName("Aufgabestellung")[0].firstChild.nodeValue);
            aufgabe=xmlDoc.getElementsByTagName("View_Coordinate");
            //
            op1=aufgabe[0].getElementsByTagName("lat")[0].firstChild.nodeValue;
            //
            op2=aufgabe[0].getElementsByTagName("lng")[0].firstChild.nodeValue;

            mapzoom=xmlDoc.getElementsByTagName("Zoom")[0].firstChild.nodeValue;


            map = L.map('mapdiv', {
                center:[op1, op2],
                zoom:mapzoom,
                scrollWheelZoom:false,
                dragging: false,
                zoomControl: false,
                attributionControl: false});
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);


            aufgabe=xmlDoc.getElementsByTagName("Type");
            mark=xmlDoc.getElementsByTagName("Coordinate");
            answer=xmlDoc.getElementsByTagName("Answer");
            length=aufgabe.length;

            for(let i=0;i<length;i++)
            {

                if(aufgabe[i].firstChild.nodeValue=="Polygon")
                {
                    latlng=new Array(mark[i].getElementsByTagName("lat").length);
                    for(let k=0;k<mark[i].getElementsByTagName("lat").length;k++)
                    {
                        latlng[k] = new Array(2);
                        latlng[k][0]=mark[i].getElementsByTagName("lng")[k].firstChild.nodeValue;
                        latlng[k][1]=mark[i].getElementsByTagName("lat")[k].firstChild.nodeValue;
                    }

                    console.log(latlng);
                    poly.push(L.polygon(latlng,{color:'red'}).on('click',function () {
                    }).addTo(map));
                }
            }

            // var fs=require('fs');
            // var xml2js=require('xml2js');
            //
            // var parser= xml2js.Parser();
            // //var builder= xml2js.Builder();
            //
            // var filepath="Example.xml";
            // fs.readFile(filepath,function (err_readFile,data) {
            //     parser.parseString(data,function (err_parseString,result) {
            //         console.log(result);
            //     })
            // })
        }
        test();

    });
</script>
</body>
</html>