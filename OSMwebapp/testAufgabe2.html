<!DOCTYPE html>
<html>
<head>
    <title>TestAufgabe</title>
    <link rel="stylesheet" href="src/leaflet.css" />
    <link rel="stylesheet" href="src/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="map.css"/>


    <script src="src/leaflet-src.js"></script>
    <script src="src/jquery-3.3.1.min.js"></script>
    <script src="src/plugins/sweetalert-master/docs/assets/sweetalert/sweetalert.min.js"></script>
</head>
<body>
<div id="mapdiv"></div>
<script type="text/javascript">
    var marker=[];
    var map;
    var op1,op2;
    var mapzoom;
    var length;
    var mark;
    var answer;
    $(document).ready(function(){
        function test() {
            if (window.XMLHttpRequest)
            {// code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp=new XMLHttpRequest();
            }
            else
            {// code for IE6, IE5
                xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
            }
            xmlhttp.open("GET","Aufgabe2.xml",false);//Read Example.xml
            xmlhttp.send();
            //var text=xmlhttp.responseText;
            var xmlDoc=xmlhttp.responseXML;//XML Object

            //alert(text);
            //var parser=new DOMParser();
            //var xmlDoc1=parser.parseFromString(text,"text/xml");//String to XML Object
            //alert(xmlDoc1+" answer");
            var aufgabe=xmlDoc.getElementsByTagName("Aufgabe");
            //alert(aufgabe.length);

            alert(aufgabe[0].getElementsByTagName("Aufgabestellung")[0].firstChild.nodeValue);
            aufgabe=xmlDoc.getElementsByTagName("View_Coordinate");
            //
            op1=aufgabe[0].getElementsByTagName("lat")[0].firstChild.nodeValue;
            //
            op2=aufgabe[0].getElementsByTagName("lng")[0].firstChild.nodeValue;

            mapzoom=xmlDoc.getElementsByTagName("Zoom")[0].firstChild.nodeValue;


            map = L.map('mapdiv', {
                center:[op1, op2],
                zoom:mapzoom,
                scrollWheelZoom:false,
                dragging: false,
                zoomControl: false,
                attributionControl: false});
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);


            aufgabe=xmlDoc.getElementsByTagName("Type");
            mark=xmlDoc.getElementsByTagName("Coordinate");
            answer=xmlDoc.getElementsByTagName("Answer");
            length=aufgabe.length;

            for(let i=0;i<length;i++)
            {
                if(aufgabe[i].firstChild.nodeValue=="Point")
                {
                    //alert(mark[0].getElementsByTagName("lat")[0].firstChild.nodeValue);
                    //alert(mark[0].getElementsByTagName("lng")[0].firstChild.nodeValue);
                   marker.push(L.marker([mark[i].getElementsByTagName("lng")[0].firstChild.nodeValue,mark[i].getElementsByTagName("lat")[0].firstChild.nodeValue]).on('click',function () {
                       alert(answer[i].firstChild.nodeValue+"");
                   }).addTo(map));
                }
            }

            alert(marker.length);
        }
        test();

    });
</script>
</body>
</html>